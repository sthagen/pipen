
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.2.2">
    
    
      
        <title>Plugins - pipen</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1118c9be.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ba0d045b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.8.1/css/all.css">
    
      <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.8.1/css/v4-shims.css">
    
      <link rel="stylesheet" href="../css/mkapi-common.css">
    
      <link rel="stylesheet" href="../style.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#plugin-hooks" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="pipen" class="md-header__button md-logo" aria-label="pipen" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pipen
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Plugins
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/pwwang/pipen/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pwwang/pipen
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="pipen" class="md-nav__button md-logo" aria-label="pipen" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    pipen
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/pwwang/pipen/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pwwang/pipen
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../basics/" class="md-nav__link">
        Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../defining-proc/" class="md-nav__link">
        Defining a process
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../running/" class="md-nav__link">
        Defining and running a pipeline
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../templating/" class="md-nav__link">
        Templating
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../channels/" class="md-nav__link">
        Channels
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../input-output/" class="md-nav__link">
        Input and output
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../script/" class="md-nav__link">
        Script
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../caching/" class="md-nav__link">
        Caching
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../error/" class="md-nav__link">
        Error handling
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../configurations/" class="md-nav__link">
        Configurations
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Plugins
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Plugins
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#plugin-hooks" class="md-nav__link">
    Plugin hooks
  </a>
  
    <nav class="md-nav" aria-label="Plugin hooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pipeline-level-hooks" class="md-nav__link">
    Pipeline-level hooks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-level-hooks" class="md-nav__link">
    Process-level hooks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#job-level-hooks" class="md-nav__link">
    Job-level hooks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loading-plugins" class="md-nav__link">
    Loading plugins
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-a-plugin" class="md-nav__link">
    Writing a plugin
  </a>
  
    <nav class="md-nav" aria-label="Writing a plugin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logging-to-the-console-from-a-plugin" class="md-nav__link">
    Logging to the console from a plugin
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plugin-gallery" class="md-nav__link">
    Plugin gallery
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../scheduler/" class="md-nav__link">
        Scheduler
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        Command line iterface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        Examples
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../CHANGELOG/" class="md-nav__link">
        Change log
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_17" type="checkbox" id="__nav_17" >
      
      <label class="md-nav__link" for="__nav_17">
        API
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_17">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_17_1" type="checkbox" id="__nav_17_1" >
      
      <label class="md-nav__link" for="__nav_17_1">
        pipen
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="pipen" data-md-level="2">
        <label class="md-nav__title" for="__nav_17_1">
          <span class="md-nav__icon md-icon"></span>
          pipen
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen/" class="md-nav__link">
        pipen
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.proc/" class="md-nav__link">
        pipen.proc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.pluginmgr/" class="md-nav__link">
        pipen.pluginmgr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.pipen/" class="md-nav__link">
        pipen.pipen
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.defaults/" class="md-nav__link">
        pipen.defaults
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.template/" class="md-nav__link">
        pipen.template
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.exceptions/" class="md-nav__link">
        pipen.exceptions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.version/" class="md-nav__link">
        pipen.version
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.progressbar/" class="md-nav__link">
        pipen.progressbar
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.utils/" class="md-nav__link">
        pipen.utils
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_17_2" type="checkbox" id="__nav_17_2" >
      
      <label class="md-nav__link" for="__nav_17_2">
        pipen.cli
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="pipen.cli" data-md-level="2">
        <label class="md-nav__title" for="__nav_17_2">
          <span class="md-nav__icon md-icon"></span>
          pipen.cli
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.cli/" class="md-nav__link">
        pipen.cli
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.cli.help/" class="md-nav__link">
        pipen.cli.help
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.cli.plugins/" class="md-nav__link">
        pipen.cli.plugins
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.cli.profile/" class="md-nav__link">
        pipen.cli.profile
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.scheduler/" class="md-nav__link">
        pipen.scheduler
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.channel/" class="md-nav__link">
        pipen.channel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/pipen.job/" class="md-nav__link">
        pipen.job
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#plugin-hooks" class="md-nav__link">
    Plugin hooks
  </a>
  
    <nav class="md-nav" aria-label="Plugin hooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pipeline-level-hooks" class="md-nav__link">
    Pipeline-level hooks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-level-hooks" class="md-nav__link">
    Process-level hooks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#job-level-hooks" class="md-nav__link">
    Job-level hooks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loading-plugins" class="md-nav__link">
    Loading plugins
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-a-plugin" class="md-nav__link">
    Writing a plugin
  </a>
  
    <nav class="md-nav" aria-label="Writing a plugin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logging-to-the-console-from-a-plugin" class="md-nav__link">
    Logging to the console from a plugin
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plugin-gallery" class="md-nav__link">
    Plugin gallery
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/pwwang/pipen/edit/master/docs/plugin.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Plugins</h1>
                
                <p><code>pipen</code> uses <a href="https://github.com/pwwang/simplug"><code>simplug</code></a> for plugin support. There are very enriched hooks available for you to write your own plugins to extend <code>pipen</code>.</p>
<h3 id="plugin-hooks">Plugin hooks</h3>
<p>To implement a function in your plugin, just simply:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pipen</span> <span class="kn">import</span> <span class="n">plugin</span>

<span class="nd">@plugin</span><span class="o">.</span><span class="n">impl</span>
<span class="p">[</span><span class="k">async</span> <span class="p">]</span><span class="k">def</span> <span class="nf">hook</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="o">...</span>
</code></pre></div>
<p>Note that you have to use keyword-arguments and they have to match the hook signature.</p>
<p>See <a href="https://github.com/pwwang/simplug"><code>simplug</code></a> for more details.</p>
<h4 id="pipeline-level-hooks">Pipeline-level hooks</h4>
<ul>
<li>
<p><code>on_setup(config)</code> (sync):</p>
<p>Setup for the plugin, mainly used for initalization and set the default values for the plugin configuration items.</p>
<p>This is only called once even when you have multiple pipelines (<code>Pipen</code> objects) in a python session.</p>
</li>
<li>
<p><code>on_init(pipen)</code> (async)</p>
<p>Called when pipeline is initialized. Note that here only default configurations are loaded (from defaults.CONFIG and config files). The configurations from <code>Pipen</code> constructor and the processes are not loaded yet. It's useful for plugins to change the default configurations.</p>
</li>
<li>
<p><code>on_start(pipen)</code> (async)</p>
<p>Right before the pipeline starts to run. The process relationships are inferred here.
You can access the start processes by <code>pipen.starts</code> and all processes by <code>pipen.procs</code> in the sequence of the execution order.</p>
</li>
<li>
<p><code>on_complete(pipen, succeeded)</code> (async)</p>
<p>After all processes finish. <code>succeeded</code> indicates whether all processes/jobs finish successfully.</p>
</li>
</ul>
<h4 id="process-level-hooks">Process-level hooks</h4>
<ul>
<li>
<p><code>on_proc_init(proc)</code> (sync)</p>
<p>Called before proc get instantiated.
Enables plugins to modify the default attributes of processes</p>
</li>
<li>
<p><code>on_proc_input_computed(proc)</code> (sync)</p>
<p>Called after process input data is computed.</p>
</li>
<li>
<p><code>on_proc_start(proc)</code> (async)</p>
<p>When process object initialization completes, including the <code>xqute</code> and job initialization. The <code>output_data</code> is also accessible here. The process is ready to run.</p>
</li>
<li>
<p><code>on_proc_shutdown(proc, sig)</code> (sync)</p>
<p>When the process is shut down (i.e. by <code>&lt;ctrl-c&gt;</code>). You can access the signal that shuts the process down by <code>sig</code>. Only first plugin (based on the priority) that implements this hook will get called.</p>
</li>
<li>
<p><code>on_proc_done(proc, succeeded)</code> (async)</p>
<p>When a process is done.</p>
</li>
</ul>
<h4 id="job-level-hooks">Job-level hooks</h4>
<ul>
<li>
<p><code>on_job_init(proc, job)</code> (async)</p>
<p>When a job is initialized</p>
</li>
<li>
<p><code>on_job_queued(proc, job)</code> (async)</p>
<p>When a job is queued in xqute. Note it might not be queued yet in the scheduler system.</p>
</li>
<li>
<p><code>on_job_submitting(proc, job)</code> (async)</p>
<p>When a job is submitting.</p>
<p>The first plugin (based on priority) have this hook return <code>False</code> will cancel the submission</p>
</li>
<li>
<p><code>on_job_submitted(proc, job)</code> (async)</p>
<p>When a job is submitted in the scheduler system.</p>
</li>
<li>
<p><code>on_job_running(proc, job)</code> (async)</p>
<p>When a job starts to run in then scheduler system.</p>
</li>
<li>
<p><code>on_job_killing(proc, job)</code> (async)</p>
<p>When a job is being killed.</p>
<p>The first plugin (based on priority) have this hook return <code>False</code> will cancel the killing</p>
</li>
<li>
<p><code>on_job_killed(proc, job)</code> (async)</p>
<p>When a job is killed</p>
</li>
<li>
<p><code>on_job_succeeded(proc, job)</code> (async)</p>
<p>When a job completes successfully</p>
</li>
<li>
<p><code>on_job_failed(proc, job)</code> (async)</p>
<p>When a job is done but failed (i.e. return_code == 1).</p>
</li>
</ul>
<h3 id="loading-plugins">Loading plugins</h3>
<p>You can specify the plugins to be loaded by specifying the names or the plugin itself in <code>plugins</code> configuration. With names, the plugins will be loaded from <a href="https://packaging.python.org/specifications/entry-points/">entry points</a>.</p>
<p>You can also disable some plugins if they are set in the lower-priority configurations. For example, you want to disable <code>pipen_verbose</code> (enabled in a configuration file) for a pipeline:</p>
<div class="highlight"><pre><span></span><code><span class="n">Pipen</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">plugins</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;no:pipen_verbose&quot;</span><span class="p">])</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When use <code>no:</code> in <code>plugins</code>, it should be all negated or positive. The best practice is that, enabled many plugins in configuration files and disable some for specific pipelines, or enable as few as possible plugins in configuration files, and enable some for specific pipelines.</p>
</div>
<h3 id="writing-a-plugin">Writing a plugin</h3>
<p>You can write your own plugin by implementing some of the above hooks. You can import the plugin directly and add it to `Pipen(..., plugins=[...]). For example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pipen</span> <span class="kn">import</span> <span class="n">plugin</span><span class="p">,</span> <span class="n">Pipen</span>

<span class="k">class</span> <span class="nc">PipenPlugin</span><span class="p">:</span>

    <span class="nd">@plugin</span><span class="o">.</span><span class="n">impl</span>
    <span class="p">[</span><span class="k">async</span> <span class="p">]</span><span class="k">def</span> <span class="nf">hook</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
        <span class="o">...</span>

<span class="n">Pipen</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">plugins</span><span class="o">=</span><span class="p">[</span><span class="n">PipenPlugin</span><span class="p">])</span>


<span class="n">You</span> <span class="n">can</span> <span class="n">also</span> <span class="n">use</span> <span class="n">the</span> <span class="n">entry</span> <span class="n">point</span> <span class="n">to</span> <span class="n">register</span> <span class="n">your</span> <span class="n">plugin</span> <span class="n">using</span> <span class="n">the</span> <span class="n">group</span> <span class="n">name</span> <span class="err">`</span><span class="n">pipen</span><span class="err">`</span>

<span class="n">For</span> <span class="err">`</span><span class="n">setup</span><span class="o">.</span><span class="n">py</span><span class="err">`</span><span class="p">,</span> <span class="n">you</span> <span class="n">will</span> <span class="n">need</span><span class="p">:</span>
<span class="err">```</span><span class="n">python</span>
<span class="n">setup</span><span class="p">(</span>
	<span class="c1"># ...</span>
	<span class="n">entry_points</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;pipen&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pipen_verbose = pipen_verbose&quot;</span><span class="p">]},</span>
	<span class="c1"># ...</span>
<span class="p">)</span>
</code></pre></div>
<p>For <code>pyproject.toml</code>:
<div class="highlight"><pre><span></span><code><span class="k">[tool.poetry.plugins.pipen]</span>
<span class="n">pipen_verbose</span> <span class="o">=</span> <span class="s">&quot;pipen_verbose&quot;</span>
</code></pre></div></p>
<p>Then the plugin <code>pipen_verbose</code> can be loaded by <code>plugins=["pipen_verbose"]</code> or disabled by <code>plugins=["no:pipen_verbose"]</code></p>
<h4 id="logging-to-the-console-from-a-plugin">Logging to the console from a plugin</h4>
<p>Of course you can do arbitrary logging from a plugin. However, to keep the consistency with main logger of <code>pipen</code>, The best practice is:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pipen.utils</span> <span class="kn">import</span> <span class="n">get_logger</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">)</span>

<span class="c1"># do some logging inside the hooks</span>
</code></pre></div>
<p>The above code will produce some logging on the console like this:</p>
<div class="highlight"><pre><span></span><code>11-04 12:00:19 I main    ╭═══════════════════════════ Process ═══════════════════════════╮
11-04 12:00:19 I main    ║ Undescribed.                                                  ║
11-04 12:00:19 I main    ╰═══════════════════════════════════════════════════════════════╯
11-04 12:00:19 I main    Process: Workdir: &#39;.pipen/process&#39;
11-04 12:00:19 I verbose Process: size: 10
11-04 12:00:19 I verbose Process: [0/9] in.a: 0
11-04 12:00:19 I verbose Process: [0/9] out.b: pipeline-0-output/Process/0/a.txt
</code></pre></div>
<h3 id="plugin-gallery">Plugin gallery</h3>
<ul>
<li><a href="https://github.com/pwwang/pipen-verbose"><code>pipen-verbose</code></a>: Add verbosal information in logs for pipen.</li>
<li><a href="https://github.com/pwwang/pipen-report"><code>pipen-report</code></a>: Generate report for pipen</li>
<li><a href="https://github.com/pwwang/pipen-filters"><code>pipen-filters</code></a>: Add a set of useful filters for pipen templates.</li>
<li><a href="https://github.com/pwwang/pipen-diagram"><code>pipen-diagram</code></a>: Draw pipeline diagrams for pipen</li>
<li><a href="https://github.com/pwwang/pipen-args"><code>pipen-args</code></a>: Command line argument parser for pipen</li>
<li><a href="https://github.com/pwwang/pipen-dry"><code>pipen-dry</code></a>: Dry runner for pipen pipelines</li>
<li><a href="https://github.com/pwwang/pipen-cli-init"><code>pipen-cli-init</code></a>: A pipen CLI plugin to create a pipen project (pipeline)</li>
<li><a href="https://github.com/pwwang/pipen-cli-run"><code>pipen-cli-run</code></a>: A pipen cli plugin to run a process or a pipeline</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../configurations/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Configurations" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Configurations
            </div>
          </div>
        </a>
      
      
        
        <a href="../scheduler/" class="md-footer__link md-footer__link--next" aria-label="Next: Scheduler" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Scheduler
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.2b46852b.min.js"></script>
      
        <script src="../js/mkapi.js"></script>
      
    
  </body>
</html>